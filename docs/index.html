<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Podcast Søgning</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">
    <input type="text" id="search" placeholder="Søg efter podcasts...">
    <div id="results"></div>
</div>

<script>
    searchInput.addEventListener('input', async function() {
        const searchText = this.value.toLowerCase();
        const filteredPodcasts = await filterPodcasts(searchText);
        displayResults(filteredPodcasts);
    });

    async function filterPodcasts(searchText) {
        const filteredPodcasts = [];

        const allPodcasts = await fetch('https://api.github.com/repos/UmFzbXVz/podcasts/contents');
        const allPodcastsJson = await allPodcasts.json();

        for (const podcast of allPodcastsJson) {
            const podcastUrl = podcast.download_url;
            const podcastData = await fetch(podcastUrl);
            const podcastDataJson = await podcastData.json();

            const titleMatch = podcastDataJson.title.toLowerCase().includes(searchText);
            const descriptionMatch = podcastDataJson.description.toLowerCase().includes(searchText);

            if (titleMatch || descriptionMatch) {
                filteredPodcasts.push(podcastDataJson);
            }
        }

        return filteredPodcasts;
    }

    function displayResults(results) {
        resultsContainer.innerHTML = '';
        if (results.length === 0) {
            resultsContainer.innerHTML = '<p>Ingen resultater fundet</p>';
            return;
        }
        results.forEach(result => {
            const resultElement = document.createElement('div');
            const titleElement = document.createElement('h3');
            const linkElement = document.createElement('a');
            linkElement.href = result.url;
            linkElement.textContent = result.title;
            titleElement.appendChild(linkElement);
            const descriptionElement = document.createElement('p');
            descriptionElement.textContent = result.description;
            resultElement.appendChild(titleElement);
            resultElement.appendChild(descriptionElement);
            resultsContainer.appendChild(resultElement);
        });
    }

    window.addEventListener('DOMContentLoaded', async () => {
        const allPodcasts = await filterPodcasts('');
        displayResults(allPodcasts);
    });
</script>

</body>
</html>
